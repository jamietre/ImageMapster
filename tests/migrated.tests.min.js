/*global iqtest, map_options */
this.tests=this.tests||[];(function(){function a(c,b,e){var d=e.split(","),f=$();
c.each(function(){for(var g=0;g<d.length;g++){if($(this).is("["+b+"='"+d[g]+"']")){f=f.add(this);
g=d.length;}}});return f;}this.tests.push(iqtest.create("basic","manipulation tests - migrated from old test suite (not organized)").add("Migrated tests",function(b,i){var g=this,d=function(j){return g.promises(j);
},h=$.mapster.utils;var c=$("#test_elements *").length;var f=$("img").mapster();f.mapster("unbind");
var e=f.mapster("test","typeof m === 'undefined'");if(!e){f=$("img").mapster(map_options);
b.equals(1,f.mapster("test","typeof m !== 'undefined' && m.map_cache && m.map_cache.length"),"Only imagemap bound images were obtained on generic create");
f=$("img,div").mapster({mapKey:"state"});b.equals(1,f.mapster("test","typeof m !== 'undefined' && m.map_cache && m.map_cache.length"),"Only imagemap bound images were obtained on generic create with other elements");
}f=$("#usa_image").mapster($.extend(map_options,{onConfigured:d("configured").resolve}));
d("configured").then(function(){var l=h.updateProps({},$.mapster.defaults,map_options);
var n=f.mapster("get_options");b.equals(n,l,"Options retrieved match initial options");
var m={isSelectable:false,areas:[{key:"MT",isDeselectable:false}]};f.mapster("set_options",m);
n=f.mapster("get_options");var k=$.extend({},l);k.isSelectable=false;b.propertyValueEquals(n,k,"Options retrieved match updated value");
b.equals(n.areas.length,6,"Area option was added");n=f.mapster("set_options",{isSelectable:true,areas:[{key:"MT",isDeselectable:true}]});
b.equals(!!f.mapster,true,"Plugin returns jQuery object");b.equals(f,$("#usa_image"),"Plugin returns jquery same object as invocation");
var o=f.mapster("get");b.collectionEquals(o,"AK,TX","Initially selected items returned with 'get'");
o=f.mapster("get","TX");b.equals(o,true,"Initially selected single item returned true with 'get'");
o=f.mapster("get","ME");b.equals(o,false,"Initially deselected single item returned false with 'get'");
a($("area"),"state","AK,HI,LA").mapster("set",true);var j=f.mapster("get");b.collectionEquals(j,"HI,AK,LA,TX","Set using area works");
f.mapster("set",false,"LA,TX");b.collectionEquals("HI,AK",f.mapster("get"),"unset using keys works");
f.mapster("set",true,"ME,OH,TX");b.collectionEquals("HI,AK,ME,OH,TX",f.mapster("get"),"set using keys works");
a($("area"),"state","AK,MT").mapster("set");b.collectionEquals("HI,ME,OH,TX,MT",f.mapster("get"),"toggling keys works");
$('area[state="AZ"]').first().click();o=f.mapster("get","AZ");b.equals(true,o,"Click-selected area returned 'get'");
b.collectionEquals("HI,ME,OH,TX,MT,AZ",f.mapster("get"),"Complete list returned with 'get'");
$('area[state="OR"]').first().click();o=f.mapster("get","OR");b.equals(o,false,"Cannot select 'staticState=false' area with click");
o=f.mapster("get","WA");b.equals(o,false,"staticState=true area is considered not selected");
n=f.mapster("get_options","WA");b.equals(n.staticState,true,"get effective options returned correct static state for WA");
n=f.mapster("get_options","OR");b.equals(n.staticState,false,"get effective options returned correct static state for OR");
$('area[state="WA"]').first().click();o=f.mapster("get","WA");b.equals(o,false,"Cannot change selection state of 'staticState=true' area with click");
f.mapster("set",true,"OR");o=f.mapster("get","OR");b.equals(o,true,"Can select 'staticState=false' area with 'set'");
f.mapster("set",false,"WA");b.equals(f.mapster("get","WA"),false,"Can deselect staticState=true' area with 'set'");
m=f.mapster("get_options");m.singleSelect=true;f.mapster("rebind",m);b.collectionEquals(f.mapster("get"),"TX,AK","Rebind with singleSelect reverted to original state");
f.mapster("set",true,"MI");b.equals(f.mapster("get"),"MI","Single select worked.");
f.mapster("set_options",{isDeselectable:false});$('area[state="MI"]').first().click();
b.equals(f.mapster("get","MI"),true,"Cannot deselect single selected item with isDeselectable=false");
$('area[state="UT"]').first().click();b.equals(f.mapster("get"),"UT","New single state selected");
f.mapster("set_options",{singleSelect:false,isDeselectable:true,areas:[{key:"ME",isDeselectable:false}]});
$('area[state="UT"]').first().click();b.equals(f.mapster("get","UT"),false,"Was able to deselect item after removing singleSelect");
f.mapster("set",true,"CA,HI,ME");$('area[state="ME"]').first().click();b.equals(f.mapster("get","ME"),true,"Could not deselect one item marked as !isDeselectable");
$('area[state="CA"]').first().click();b.equals(f.mapster("get","CA"),false,"Could deselect other items ");
b.equals(f.mapster("highlight"),null,"nothing is highlighted");$('area[state="CA"]').first().mapster("highlight");
b.equals(f.mapster("highlight"),"CA","highlighted manually");f.mapster("highlight","LA");
b.equals(f.mapster("highlight"),"LA","highlighted manually using other technique");
f.mapster("highlight",false);b.equals(f.mapster("highlight"),null,"everything unhighlighted");
f.mapster("unbind");b.equals($("canvas").length,0,"No canvases remain after an unbind.");
b.equals($("#test_elements *").length,c,"# elements in DOM is the same.");});}));
}());