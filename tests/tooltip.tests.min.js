/*global Test: true, iqtest, image, map_options, areas,  */
this.tests=this.tests||[];this.tests.push(iqtest.create("tooltips","tests for imagemapster tooltips").add("Imagemap tooltips",function(b,g){var e=this,c=function(a){return e.promises(a);
},f=$.extend(map_options,{onConfigured:c("configured").resolve}),d=image.mapster(f);
function h(j,a){var i={};i[j]=a?function(k){k=k||{};k.this_context=this;a(k);}:null;
d.mapster("set_options",i);}d.mapster("set_options",{areas:[{key:"TX",toolTip:"Don't mess with Texas",toolTipClose:"tooltip-click"}]});
c("configured").then(function(){b.equals(0,$(".mapster_tooltip").length);h("onShowToolTip",c("shown1").resolve);
$("area[state=TX]").mouseover();c("shown1").then(function(){b.equals(1,$(".mapster_tooltip").length,"Tooltip was shown");
h("onShowToolTip",null);h("onMouseover",c("removed1").resolve);$("area[state=NV]").mouseover();
});c("removed1").then(function(){b.equals(0,$(".mapster_tooltip").length,"Activating another area removes tooltip");
h("onMouseover",null);h("onShowToolTip",c("shown2").resolve);$("area[state=TX]").mouseover();
});c("shown2").then(function(){b.equals(1,$(".mapster_tooltip").length,"Tooltip whas shown again");
h("onShowToolTip",null);h("onHideToolTip",c("click1").resolve);$(".mapster_tooltip").click();
});c("click1").then(function(){b.equals(0,$(".mapster_tooltip").length,"Clicking tooltip removes it");
c("finished").resolve();});});b.resolves(c("finished"),"The last test resolved");
}));